---
description: Analyzing the architecture of the project
globs: 
alwaysApply: false
---
# TYPR Application Architecture

This document outlines the architecture of the TYPR application, a type racing platform where users can race against each other through typing prompted text.

## Components

1. **Frontend (React + TypeScript)**
   - Maintains the same UI components
   - Replaces Firebase listeners with Socket.io client connections
   - Communicates directly with the WebSocket server for real-time updates

2. **WebSocket Server (Node.js + Socket.io)**
   - Central hub for real-time game communication
   - Maintains authoritative game state in memory
   - Manages rooms and player connections
   - Broadcasts game events and player progress
   - Handles game logic (countdown, race start/end)

3. **API Endpoints (Express.js)**
   - Routes for room creation, deletion, validation

3. **Redis**
   - Facilitates matchmaking by storing player queue information
   - Enables WebSocket scaling through Socket.io Redis adapter
   - Provides fast in-memory storage for rooms collection

5. **Firebase (Reduced Role)**
   - Handle authentication
   - Store user ELO and Match History

6. **Firebase Cloud Functions (Maintenance)**
   - Handles leaderboard updates

## Data Flow

1. **Client → Server**:
   - Client sends exact text progress updates directly to the server via WebSockets
   - When a player finishes typing, they send a "Finished" event to the server
   - All real-time game interactions flow directly through WebSocket connections

2. **Server → Client**:
   - Server broadcasts typing progress of all other players to each client
   - Server manages game state transitions and notifies all clients

3. **Server → Databases**:
   - Stores match results in Firestore after game completion
   - Uses Redis for matchmaking and ephemeral data


## Authentication and User Management

- Firebase Authentication for user accounts
- User profiles with customizable usernames
- Statistics tracking across game modes
- ELO rating system for skill measurement
